{"ast":null,"code":"var _jsxFileName = \"/Users/macbook/Desktop/trydo/trydo-crossChallenge/client/src/context/authentication/authState.js\";\nimport React, { useReducer } from 'react';\nimport authContext from './authContext';\nimport authReducer from './authReducer';\nimport clientAxios from '../../config/axios';\nimport tokenAuth from '../../config/tokenAuth';\nimport { REGISTER_SUCCESSFUL, REGISTER_ERROR, GET_USER, LOGIN_SUCCESSFUL, LOGIN_ERROR, LOG_OUT } from \"../../types\";\n\nconst AuthState = props => {\n  const initialState = {\n    token: localStorage.getItem('token'),\n    authenticated: null,\n    user: null,\n    message: null,\n    loading: true\n  };\n  const [state, dispatch] = useReducer(authReducer, initialState);\n\n  const registerUser = async data => {\n    try {\n      const response = await clientAxios.post('/api/users', data);\n      console.log(response.data);\n      dispatch({\n        type: REGISTER_SUCCESSFUL,\n        payload: response.data\n      }); //Get user\n\n      userAuthenticated();\n    } catch (err) {\n      // console.log(err.response.data.msg);\n      const alert = {\n        msg: err.response.data.msg,\n        category: 'alert'\n      };\n      dispatch({\n        type: REGISTER_ERROR,\n        payload: alert\n      });\n    }\n\n    ;\n  }; //Return authenticated user\n\n\n  const userAuthenticated = async () => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      //Function to send token in headers\n      tokenAuth(token);\n    }\n\n    ;\n\n    try {\n      const response = await clientAxios.get('/api/auth'); // console.log(response);\n\n      dispatch({\n        type: GET_USER,\n        payload: response.data.user\n      });\n    } catch (err) {\n      console.log(err.response);\n      dispatch({\n        type: LOGIN_ERROR\n      });\n    }\n\n    ;\n  }; //User login\n\n\n  const login = async data => {\n    try {\n      const response = await clientAxios.post('/api/auth', data);\n      dispatch({\n        type: LOGIN_SUCCESSFUL,\n        payload: response.data\n      }); //Get user\n\n      userAuthenticated();\n    } catch (err) {\n      console.log(err.response.data.msg);\n      const alert = {\n        msg: err.response.data.msg,\n        category: 'alert'\n      };\n      dispatch({\n        type: LOGIN_ERROR,\n        payload: alert\n      });\n    }\n\n    ;\n  }; //Logout\n\n\n  const logout = () => {\n    dispatch({\n      type: LOG_OUT\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(authContext.Provider, {\n    value: {\n      token: state.token,\n      authenticated: state.authenticated,\n      user: state.user,\n      message: state.message,\n      loading: state.loading,\n      registerUser,\n      userAuthenticated,\n      login,\n      logout\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }\n  }, props.children);\n};\n\nexport default AuthState;","map":{"version":3,"sources":["/Users/macbook/Desktop/trydo/trydo-crossChallenge/client/src/context/authentication/authState.js"],"names":["React","useReducer","authContext","authReducer","clientAxios","tokenAuth","REGISTER_SUCCESSFUL","REGISTER_ERROR","GET_USER","LOGIN_SUCCESSFUL","LOGIN_ERROR","LOG_OUT","AuthState","props","initialState","token","localStorage","getItem","authenticated","user","message","loading","state","dispatch","registerUser","data","response","post","console","log","type","payload","userAuthenticated","err","alert","msg","category","get","login","logout","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from 'react';\nimport authContext from './authContext';\nimport authReducer from './authReducer';\nimport clientAxios from '../../config/axios';\nimport tokenAuth from '../../config/tokenAuth';\n\nimport {\n    REGISTER_SUCCESSFUL,\n    REGISTER_ERROR,\n    GET_USER,\n    LOGIN_SUCCESSFUL,\n    LOGIN_ERROR,\n    LOG_OUT\n} from \"../../types\";\n\nconst AuthState = props => {\n    const initialState = {\n        token: localStorage.getItem('token'),\n        authenticated: null,\n        user: null,\n        message: null,\n        loading: true\n    };\n\n    const [ state, dispatch ] = useReducer(authReducer, initialState);\n\n    const registerUser = async data => {\n        try {\n            const response = await clientAxios.post('/api/users', data);\n            console.log(response.data);\n\n            dispatch({\n                type: REGISTER_SUCCESSFUL,\n                payload: response.data\n            });\n\n            //Get user\n            userAuthenticated();\n\n        } catch (err) {\n            // console.log(err.response.data.msg);\n            const alert = {\n                msg: err.response.data.msg,\n                category: 'alert'\n            }\n\n            dispatch({\n                type: REGISTER_ERROR,\n                payload: alert\n            });\n        };\n    };\n\n    //Return authenticated user\n    const userAuthenticated = async () => {\n        const token = localStorage.getItem('token');\n        if(token) {\n            //Function to send token in headers\n            tokenAuth(token);\n        };\n        try {\n            const response = await clientAxios.get('/api/auth');\n            // console.log(response);\n            dispatch({\n                type: GET_USER,\n                payload: response.data.user\n            });\n\n        } catch (err) {\n            console.log(err.response);\n            dispatch({\n                type: LOGIN_ERROR\n            });\n        };\n    };\n\n    //User login\n    const login = async data => {\n        try {\n            const response = await clientAxios.post('/api/auth', data);\n            dispatch({\n                type: LOGIN_SUCCESSFUL,\n                payload: response.data\n            });\n            //Get user\n            userAuthenticated();\n\n        } catch (err) {\n            console.log(err.response.data.msg);\n            const alert = {\n                msg: err.response.data.msg,\n                category: 'alert'\n            }\n\n            dispatch({\n                type: LOGIN_ERROR,\n                payload: alert\n            });\n        };\n    };\n\n    //Logout\n    const logout = () => {\n        dispatch({\n            type: LOG_OUT\n        });\n    };\n\n    return(\n        <authContext.Provider\n            value={{\n                token: state.token,\n                authenticated: state.authenticated,\n                user: state.user,\n                message: state.message,\n                loading: state.loading,\n                registerUser,\n                userAuthenticated,\n                login,\n                logout\n            }}\n        >\n            {props.children}\n        </authContext.Provider>\n    )\n}\n\nexport default AuthState;\n"]},"metadata":{},"sourceType":"module"}